var logToken="",pageIsLogin=!1;function addEventsOnA(){for(let e of document.getElementsByTagName("a")){if(e.dataset.isProccessed)continue;let t=e.href;e.href="#",e.dataset.eventType||(e.dataset.eventType="click"),e.dataset.targetDiv||(e.dataset.targetDiv="pageView"),e.dataset.path=t.replace(/https?:\/\/[a-zA-Z]+(:[0-9]+)?\/(#\/)?/,""),e.dataset.isProccessed=!0,e.addEventListener(e.dataset.eventType,loadPage),void 0!==e.dataset.defaultTab&&e.dispatchEvent(new Event(e.dataset.eventType))}}function loadPage(){console.log(this),pageIsLogin=!1;let e=new XMLHttpRequest,t="./pages/"+this.dataset.path+".html",a=this;e.addEventListener("readystatechange",function(t){4==e.readyState&&(200==e.status?(document.getElementById(a.dataset.targetDiv).innerHTML=e.responseText,addEventsOnA(),isLoggedIn()):loadBlankPage(document.getElementById(a.dataset.targetDiv)))}),e.open("GET",t,!0),e.send()}function loadBlankPage(e){let t=new XMLHttpRequest;t.addEventListener("readystatechange",function(a){4==t.readyState&&(200==t.status?e.innerHTML=t.responseText:e.innerHTML="<h1>Page not found</h1>")}),t.open("GET","./pages/blank/index.html",!0),t.send()}function isLoggedIn(){if(""===logToken&&!pageIsLogin){logToken="a",pageIsLogin=!0;let e=document.createElement("a");e.dataset.eventType="click",e.dataset.targetDiv="body",e.dataset.path="login/index",e.dataset.isProccessed=!0,e.addEventListener(e.dataset.eventType,loadPage),e.dispatchEvent(new Event(e.dataset.eventType))}}function appendScript(e){let t=document.createElement("script");t.type="text/javascript",t.charset="utf-8",t.src=e,document.head.append(t)}async function hash(e){const t=new TextEncoder("utf-8").encode(e),a=await crypto.subtle.digest("SHA-512",t);return Array.from(new Uint8Array(a)).map(e=>("00"+e.toString(16)).slice(-2)).join("")}window.onload=(()=>{addEventsOnA(),isLoggedIn()}),hash("abc").then(e=>console.log(e));
